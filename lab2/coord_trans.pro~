PRO hadec_radec, jDay
;+
; OVERVIEW
; --------
; converts hour angle and declination to right ascension and declination
; using matrix operations
;
; PARAMETERS
; ----------
; jDay: float
;     the julian day of measurements
;
; OUTPUTS
; -------
; raDec: float
;     the values of right ascension and declination
;-

  caldat, jDay, mo, day, yr, hr, min, sec ; unpack jday to get local times
  gHr = hr - 8 ; get hr to be in gmt time
  
  berkLong = -122.268133        ; longitude of berkeley in degrees
  berkLat = 37.875463 ; latitude of berkeley in degrees
  
  solarTime = [gHr*(360/24)]$              ; convert hrs to degrees
             +[min*(360/24)*(1/60)]$     ; convert minutes to degrees
             +[sec*(360/24)*(1/60)*(1/60)]   ; convert seconds to degrees
  
  LST = solarTime + berkLong                ; get local mean sidereal time

  raDec_haDec = [ [cos(LST),  sin(LST), 0]$   ; make rotation matrix
                  [sin(LST), -cos(LST), 0]$   ; goes from (ra,dec) -> (ha,dec)
                  [0,                0, 1] ]
  
  haDec_raDec = TRANSPOSE(raDec_haDec) ; transpose of matrix gives 
                                ; rotation from (ha,dec) -> (ra,dec)
